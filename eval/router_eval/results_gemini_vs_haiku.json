{
  "evalId": "eval-I6T-2026-01-04T15:59:31",
  "results": {
    "version": 3,
    "timestamp": "2026-01-04T15:59:31.956Z",
    "prompts": [
      {
        "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "id": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "provider": "claude-3-haiku",
        "metrics": {
          "score": 19,
          "testPassCount": 18,
          "testFailCount": 2,
          "testErrorCount": 0,
          "assertPassCount": 38,
          "assertFailCount": 2,
          "totalLatencyMs": 22715,
          "tokenUsage": {
            "prompt": 53498,
            "completion": 1366,
            "cached": 0,
            "total": 54864,
            "numRequests": 20,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      },
      {
        "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "id": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "provider": "gemini-flash",
        "metrics": {
          "score": 5,
          "testPassCount": 5,
          "testFailCount": 15,
          "testErrorCount": 0,
          "assertPassCount": 10,
          "assertFailCount": 30,
          "totalLatencyMs": 16701,
          "tokenUsage": {
            "prompt": 55378,
            "completion": 1069,
            "cached": 0,
            "total": 56447,
            "numRequests": 20,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      }
    ],
    "results": [
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));\n"
              }
            }
          ]
        },
        "id": "69933c61-ec2c-4764-aa30-6749e0524e21",
        "latencyMs": 951,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Ohio voters say about jobs?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\", \"race-007-fg-003-youngstown-working-class\"]}\n```",
          "tokenUsage": {
            "total": 2840,
            "prompt": 2771,
            "completion": 69,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Ohio voters say about jobs?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Ohio voters say about jobs?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));\n"
              }
            }
          ]
        },
        "id": "0a9764e1-5b21-4dca-a406-f9254d7dfb18",
        "latencyMs": 1000,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Ohio voters say about jobs?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-007-fg-001-cleveland-suburbs\",\n    \"race-007-fg-002-columbus-educated\",\n    \"race-007-fg-003-youngstown-working-class\"\n  ]\n}",
          "tokenUsage": {
            "total": 2744,
            "prompt": 2677,
            "completion": 67,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Ohio voters say about jobs?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Ohio voters say about jobs?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
              }
            }
          ]
        },
        "id": "76689c47-cf7f-48c7-bd2d-a459c0de0309",
        "latencyMs": 1434,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do Michigan voters feel about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-001-fg-001-detroit-suburbs\", \"race-001-fg-002-grand-rapids\", \"race-001-fg-003-swing-voters-statewide\", \"race-001-fg-004-northern-rural\", \"race-009-fg-001-detroit-suburbs\", \"race-009-fg-002-flint-saginaw\", \"race-009-fg-003-grand-rapids\"]}\n```",
          "tokenUsage": {
            "total": 2915,
            "prompt": 2772,
            "completion": 143,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do Michigan voters feel about the economy?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do Michigan voters feel about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
              }
            }
          ]
        },
        "id": "7a2f0cb4-539f-4986-89d4-d1067727526e",
        "latencyMs": 1428,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do Michigan voters feel about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-001-fg-001-detroit-suburbs\",\n    \"race-001-fg-002-grand-rapids\",\n    \"race-001-fg-003-swing-voters-statewide\",\n    \"race-001-fg-004-northern-rural\",\n    \"race-009-fg-001-detroit-suburbs\",\n    \"race-009-fg-002-flint-saginaw\",\n    \"race-009-fg-003-grand-rapids\"\n  ]\n}",
          "tokenUsage": {
            "total": 2809,
            "prompt": 2678,
            "completion": 131,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do Michigan voters feel about the economy?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do Michigan voters feel about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "ea3af816-4126-43dd-b686-0326ff808a45",
        "latencyMs": 1318,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania voters on healthcare",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-002-fg-001-philadelphia-suburbs\", \"race-002-fg-002-pittsburgh-area\", \"race-002-fg-003-scranton-working-class\", \"race-010-fg-001-philadelphia-suburbs\", \"race-010-fg-002-pittsburgh\", \"race-010-fg-003-scranton-nepa\"]}\n```",
          "tokenUsage": {
            "total": 2892,
            "prompt": 2767,
            "completion": 125,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania voters on healthcare"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania voters on healthcare"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "4d0b7f7e-ba85-42f5-af4b-42c36b17a881",
        "latencyMs": 1149,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania voters on healthcare",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-002-fg-001-philadelphia-suburbs\",\n    \"race-002-fg-002-pittsburgh-area\", \n    \"race-002-fg-003-scranton-working-class\",\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-010-fg-002-pittsburgh\",\n    \"race-010-fg-003-scranton-nepa\"\n  ]\n}",
          "tokenUsage": {
            "total": 2790,
            "prompt": 2673,
            "completion": 117,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania voters on healthcare"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania voters on healthcare"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
              }
            }
          ]
        },
        "id": "3314794d-1e93-4d07-a230-7d8944541d4a",
        "latencyMs": 1153,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Wisconsin voters think about education?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-003-fg-001-milwaukee-suburbs\", \"race-003-fg-002-madison-area\", \"race-003-fg-003-fox-valley\", \"race-012-fg-001-milwaukee-suburbs\", \"race-012-fg-002-madison\", \"race-012-fg-003-fox-valley\"]}\n```",
          "tokenUsage": {
            "total": 2889,
            "prompt": 2771,
            "completion": 118,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Wisconsin voters think about education?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Wisconsin voters think about education?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
              }
            }
          ]
        },
        "id": "6e897a6e-ec73-450c-8d23-1c9b0bdaf86c",
        "latencyMs": 1110,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Wisconsin voters think about education?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"focus_group_ids\": [\"race-012-fg-001-milwaukee-suburbs\", \"race-012-fg-002-madison\", \"race-012-fg-003-fox-valley\"]}",
          "tokenUsage": {
            "total": 2725,
            "prompt": 2677,
            "completion": 48,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Wisconsin voters think about education?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Wisconsin voters think about education?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));\n"
              }
            }
          ]
        },
        "id": "2575cdc4-1810-4c0a-885f-e1be25d8e397",
        "latencyMs": 823,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Georgia voters on voting rights",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-004-fg-001-atlanta-suburbs\", \"race-004-fg-002-atlanta-black-voters\", \"race-004-fg-003-rural-southwest\"]}\n```",
          "tokenUsage": {
            "total": 2838,
            "prompt": 2768,
            "completion": 70,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Georgia voters on voting rights"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Georgia voters on voting rights"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));\n"
              }
            }
          ]
        },
        "id": "008ba47d-a3c0-4337-9f3a-15fb1b9cd2e8",
        "latencyMs": 2118,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Georgia voters on voting rights",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-004-fg-001-atlanta-suburbs\",\n    \"race-004-fg-002-atlanta-black-voters\",\n    \"race-004-fg-003-rural-southwest\"\n  ]\n}",
          "tokenUsage": {
            "total": 2740,
            "prompt": 2674,
            "completion": 66,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Georgia voters on voting rights"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Georgia voters on voting rights"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));\n"
              }
            }
          ]
        },
        "id": "df8dcda6-e00f-4334-8380-61c56624b3ab",
        "latencyMs": 800,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Arizona immigration concerns",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-005-fg-002-latino-phoenix\"]}\n```",
          "tokenUsage": {
            "total": 2797,
            "prompt": 2766,
            "completion": 31,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Arizona immigration concerns"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Arizona immigration concerns"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));\n"
              }
            }
          ]
        },
        "id": "3c9449db-6c61-4c87-829b-891744e157d0",
        "latencyMs": 936,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Arizona immigration concerns",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"focus_group_ids\": [\"race-005-fg-001-maricopa-suburbs\", \"race-005-fg-002-latino-phoenix\", \"race-005-fg-003-tucson\"]}",
          "tokenUsage": {
            "total": 2723,
            "prompt": 2672,
            "completion": 51,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Arizona immigration concerns"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Arizona immigration concerns"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));\n"
              }
            }
          ]
        },
        "id": "8af82782-a430-4c38-abcb-d86550b4f8c7",
        "latencyMs": 679,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: North Carolina suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-011-fg-001-charlotte-suburbs\"]}\n```",
          "tokenUsage": {
            "total": 2799,
            "prompt": 2767,
            "completion": 32,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "North Carolina suburban voters"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "North Carolina suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));\n"
              }
            }
          ]
        },
        "id": "0f3f0563-be8b-4932-8676-275b312570fd",
        "latencyMs": 1378,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: North Carolina suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-011-fg-001-charlotte-suburbs\"\n  ]\n}",
          "tokenUsage": {
            "total": 2707,
            "prompt": 2673,
            "completion": 34,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "North Carolina suburban voters"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "North Carolina suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));\n"
              }
            }
          ]
        },
        "id": "f3a08509-ed35-4c3e-9dfb-fbba5b18380f",
        "latencyMs": 660,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Montana rural voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-008-fg-002-rural-ranching\"]}\n```",
          "tokenUsage": {
            "total": 2797,
            "prompt": 2766,
            "completion": 31,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Montana rural voters"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Montana rural voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));\n"
              }
            }
          ]
        },
        "id": "871ccc85-bd6b-439d-b6c3-ed7c810c0b3a",
        "latencyMs": 763,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Montana rural voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-008-fg-002-rural-ranching\"\n  ]\n}",
          "tokenUsage": {
            "total": 2707,
            "prompt": 2672,
            "completion": 35,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Montana rural voters"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Montana rural voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
              }
            }
          ]
        },
        "id": "390cdc93-0340-4df8-b8bf-fa853f383054",
        "latencyMs": 1294,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do working-class voters think about trade?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\n    \"race-002-fg-002-pittsburgh-area\",\n    \"race-002-fg-003-scranton-working-class\",\n    \"race-007-fg-003-youngstown-working-class\",\n    \"race-009-fg-002-flint-saginaw\",\n    \"race-010-fg-003-scranton-nepa\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 2901,
            "prompt": 2773,
            "completion": 128,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do working-class voters think about trade?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 8,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do working-class voters think about trade?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
              }
            }
          ]
        },
        "id": "85d08266-09e2-429e-b39e-22e97303d655",
        "latencyMs": 1213,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do working-class voters think about trade?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-002-fg-002-pittsburgh-area\",\n    \"race-003-fg-003-fox-valley\",\n    \"race-007-fg-003-youngstown-working-class\",\n    \"race-009-fg-002-flint-saginaw\"\n  ]\n}",
          "tokenUsage": {
            "total": 2766,
            "prompt": 2679,
            "completion": 87,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do working-class voters think about trade?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 8,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do working-class voters think about trade?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
              }
            }
          ]
        },
        "id": "6e787442-07e6-4783-8cca-581ee96869fb",
        "latencyMs": 793,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Latino voters on immigration",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\n    \"focus_group_ids\": [\n        \"race-005-fg-002-latino-phoenix\",\n        \"race-006-fg-003-latino-vegas\"\n    ]\n}\n```",
          "tokenUsage": {
            "total": 2830,
            "prompt": 2767,
            "completion": 63,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Latino voters on immigration"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 9,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Latino voters on immigration"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
              }
            }
          ]
        },
        "id": "8f50008e-676c-4748-b1f6-c84ef4f455cf",
        "latencyMs": 930,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Latino voters on immigration",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-004-fg-002-atlanta-black-voters\",\n    \"race-006-fg-003-latino-vegas\"\n  ]\n}",
          "tokenUsage": {
            "total": 2724,
            "prompt": 2673,
            "completion": 51,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Latino voters on immigration"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 9,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Latino voters on immigration"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));\n"
              }
            }
          ]
        },
        "id": "fa85b24d-d00b-409c-a299-c2602e260270",
        "latencyMs": 691,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Black voters in Georgia",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-004-fg-002-atlanta-black-voters\"]}\n```",
          "tokenUsage": {
            "total": 2800,
            "prompt": 2767,
            "completion": 33,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Black voters in Georgia"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 10,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Black voters in Georgia"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));\n"
              }
            }
          ]
        },
        "id": "9bb55be5-f17f-4a25-ae09-53257986a5e9",
        "latencyMs": 865,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Black voters in Georgia",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-004-fg-002-atlanta-black-voters\",\n    \"race-004-fg-003-rural-southwest\"\n  ]\n}",
          "tokenUsage": {
            "total": 2724,
            "prompt": 2673,
            "completion": 51,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Black voters in Georgia"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 10,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Black voters in Georgia"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
              }
            }
          ]
        },
        "id": "ce3184cf-586a-4398-85f7-b2829e472988",
        "latencyMs": 886,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: College-educated suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-002-fg-001-philadelphia-suburbs\", \"race-007-fg-002-columbus-educated\", \"race-010-fg-001-philadelphia-suburbs\"]}\n```",
          "tokenUsage": {
            "total": 2836,
            "prompt": 2768,
            "completion": 68,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "College-educated suburban voters"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 11,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "College-educated suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
              }
            }
          ]
        },
        "id": "ea7c3f97-cf0e-4d38-8a23-d7e7b872cb97",
        "latencyMs": 1328,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: College-educated suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"focus_group_ids\": [\"race-001-fg-002-grand-rapids\", \"race-002-fg-001-philadelphia-suburbs\", \"race-005-fg-001-maricopa-suburbs\", \"race-010-fg-001-philadelphia-suburbs\", \"race-011-fg-002-research-triangle\"]}",
          "tokenUsage": {
            "total": 2752,
            "prompt": 2674,
            "completion": 78,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "College-educated suburban voters"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 11,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "College-educated suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "116cc7fd-e993-4633-9b83-6dbd6c85208e",
        "latencyMs": 602,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do voters think about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"all\": true}",
          "tokenUsage": {
            "total": 2685,
            "prompt": 2677,
            "completion": 8,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do voters think about the economy?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 12,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do voters think about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "ee36529a-2cdd-448b-ab42-380ec90f1003",
        "latencyMs": 523,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do voters think about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "{\"all\": true}\n",
          "tokenUsage": {
            "total": 2777,
            "prompt": 2771,
            "completion": 6,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do voters think about the economy?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 12,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do voters think about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "2a830e3f-5c51-48f4-b02b-c4af9294cb33",
        "latencyMs": 741,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do people feel about inflation?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"all\": true}",
          "tokenUsage": {
            "total": 2684,
            "prompt": 2676,
            "completion": 8,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do people feel about inflation?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 13,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do people feel about inflation?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "3ea5ba50-0b97-4dcc-b8ad-ed05f6c738f3",
        "latencyMs": 544,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do people feel about inflation?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "{\"all\": true}\n",
          "tokenUsage": {
            "total": 2776,
            "prompt": 2770,
            "completion": 6,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do people feel about inflation?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 13,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do people feel about inflation?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "31c27b68-cf27-4992-884d-af6209d60c1b",
        "latencyMs": 1847,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Voter concerns about healthcare costs",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-002-fg-001-philadelphia-suburbs\",\n    \"race-002-fg-002-pittsburgh-area\",\n    \"race-002-fg-003-scranton-working-class\",\n    \"race-007-fg-001-cleveland-suburbs\",\n    \"race-007-fg-002-columbus-educated\",\n    \"race-007-fg-003-youngstown-working-class\",\n    \"race-009-fg-001-detroit-suburbs\",\n    \"race-009-fg-002-flint-saginaw\",\n    \"race-009-fg-003-grand-rapids\",\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-010-fg-002-pittsburgh\",\n    \"race-010-fg-003-scranton-nepa\"\n  ]\n}",
          "tokenUsage": {
            "total": 2887,
            "prompt": 2675,
            "completion": 212,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Voter concerns about healthcare costs"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 14,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Voter concerns about healthcare costs"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "063fc580-84cd-4231-8e9e-42cb71d1c6f8",
        "latencyMs": 692,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Voter concerns about healthcare costs",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "{\"all\": true}\n",
          "tokenUsage": {
            "total": 2774,
            "prompt": 2768,
            "completion": 6,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Voter concerns about healthcare costs"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 14,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Voter concerns about healthcare costs"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "16bd96cd-6d93-40c3-9a88-3ae1b8d77790",
        "latencyMs": 1597,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What messaging resonates with swing voters?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-001-fg-001-detroit-suburbs\",\n    \"race-001-fg-002-grand-rapids\",\n    \"race-001-fg-003-swing-voters-statewide\",\n    \"race-003-fg-001-milwaukee-suburbs\",\n    \"race-003-fg-003-fox-valley\",\n    \"race-004-fg-001-atlanta-suburbs\",\n    \"race-005-fg-001-maricopa-suburbs\",\n    \"race-009-fg-001-detroit-suburbs\",\n    \"race-009-fg-003-grand-rapids\"\n  ]\n}",
          "tokenUsage": {
            "total": 2837,
            "prompt": 2677,
            "completion": 160,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What messaging resonates with swing voters?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 15,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What messaging resonates with swing voters?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "ae210fe4-bd4e-4823-9071-996e7e638c4e",
        "latencyMs": 547,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What messaging resonates with swing voters?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "{\"all\": true}\n",
          "tokenUsage": {
            "total": 2776,
            "prompt": 2770,
            "completion": 6,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What messaging resonates with swing voters?"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 15,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What messaging resonates with swing voters?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
              }
            }
          ]
        },
        "id": "01afbc30-7921-4715-b436-4da1c1e5a0fa",
        "latencyMs": 743,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Working-class Ohio voters on manufacturing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-007-fg-003-youngstown-working-class\"]}\n```",
          "tokenUsage": {
            "total": 2802,
            "prompt": 2770,
            "completion": 32,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Working-class Ohio voters on manufacturing"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 16,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Working-class Ohio voters on manufacturing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
              }
            }
          ]
        },
        "id": "819b6cf6-76d6-4b41-bf17-da6177491d8b",
        "latencyMs": 869,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Working-class Ohio voters on manufacturing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-007-fg-003-youngstown-working-class\"\n  ]\n}",
          "tokenUsage": {
            "total": 2713,
            "prompt": 2676,
            "completion": 37,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Working-class Ohio voters on manufacturing"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 16,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Working-class Ohio voters on manufacturing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "d7e60c46-a206-4f1c-984b-ed8a3dcbfba9",
        "latencyMs": 766,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania suburban voters 2024",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-010-fg-001-philadelphia-suburbs\"]}\n```",
          "tokenUsage": {
            "total": 2802,
            "prompt": 2771,
            "completion": 31,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania suburban voters 2024"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 17,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania suburban voters 2024"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "6ebc7b8a-666e-4fdd-989a-5dd8dc8aecb4",
        "latencyMs": 875,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania suburban voters 2024",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-010-fg-002-pittsburgh\"\n  ]\n}",
          "tokenUsage": {
            "total": 2724,
            "prompt": 2675,
            "completion": 49,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania suburban voters 2024"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 17,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania suburban voters 2024"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.reason;\n"
              }
            }
          ]
        },
        "id": "1a071984-957c-4b36-b0e7-ffe59289a562",
        "latencyMs": 889,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: California voters on housing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}",
          "tokenUsage": {
            "total": 2715,
            "prompt": 2673,
            "completion": 42,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "California voters on housing"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.reason;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 18,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "California voters on housing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.reason;\n"
              }
            }
          ]
        },
        "id": "26ee7e23-f16e-4683-b853-fdbc59f72ff2",
        "latencyMs": 808,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: California voters on housing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n",
          "tokenUsage": {
            "total": 2807,
            "prompt": 2767,
            "completion": 40,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "California voters on housing"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.reason;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 18,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "California voters on housing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
              }
            }
          ]
        },
        "id": "234ff199-cf13-4236-a462-1f03b156c4f1",
        "latencyMs": 596,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Cleveland suburbs on local issues",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:google/gemini-2.0-flash-001",
          "label": "gemini-flash"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\"]}\n```",
          "tokenUsage": {
            "total": 2799,
            "prompt": 2768,
            "completion": 31,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Cleveland suburbs on local issues"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 19,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Cleveland suburbs on local issues"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
              }
            }
          ]
        },
        "id": "22e81f31-08a8-445b-827a-c498f8f4059d",
        "latencyMs": 1077,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Cleveland suburbs on local issues",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-007-fg-001-cleveland-suburbs\"\n  ]\n}",
          "tokenUsage": {
            "total": 2708,
            "prompt": 2674,
            "completion": 34,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Cleveland suburbs on local issues"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 19,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Cleveland suburbs on local issues"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      }
    ],
    "stats": {
      "successes": 23,
      "failures": 17,
      "errors": 0,
      "tokenUsage": {
        "prompt": 108876,
        "completion": 2435,
        "cached": 0,
        "total": 111311,
        "numRequests": 40,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      },
      "durationMs": 10411
    }
  },
  "config": {
    "tags": {},
    "description": "Router Model Comparison - Haiku vs Gemini Flash",
    "prompts": [
      "file:///Users/tanayvenkata/dev/focus-group/eval/router_eval/prompts/router_v2.txt"
    ],
    "providers": [
      {
        "id": "openrouter:anthropic/claude-3-haiku",
        "label": "claude-3-haiku",
        "config": {
          "temperature": 0,
          "max_tokens": 500
        }
      },
      {
        "id": "openrouter:google/gemini-2.0-flash-001",
        "label": "gemini-flash",
        "config": {
          "temperature": 0,
          "max_tokens": 500
        }
      }
    ],
    "tests": [
      {
        "vars": {
          "query": "What did Ohio voters say about jobs?"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-007'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "How do Michigan voters feel about the economy?"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Pennsylvania voters on healthcare"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What did Wisconsin voters think about education?"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Georgia voters on voting rights"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-004'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Arizona immigration concerns"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-005'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "North Carolina suburban voters"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-011'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Montana rural voters"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && ids.every(id => id.includes('race-008'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What do working-class voters think about trade?"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\n// Should filter to working-class FGs OR return all (acceptable)\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Latino voters on immigration"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Black voters in Georgia"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black') || id.includes('race-004'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "College-educated suburban voters"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\n// Can filter or return all - both acceptable for this query\nreturn result.all === true || (result.focus_group_ids && result.focus_group_ids.length > 0);\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What do voters think about the economy?"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "How do people feel about inflation?"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Voter concerns about healthcare costs"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What messaging resonates with swing voters?"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Working-class Ohio voters on manufacturing"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Pennsylvania suburban voters 2024"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "California voters on housing"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.reason;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Cleveland suburbs on local issues"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
          }
        ]
      }
    ],
    "scenarios": [],
    "env": {},
    "defaultTest": {
      "vars": {
        "manifest": "file://manifest.txt"
      },
      "assert": [],
      "options": {},
      "metadata": {}
    },
    "outputPath": [
      "results_gemini_vs_haiku.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {}
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.120.8",
    "nodeVersion": "v25.2.1",
    "platform": "darwin",
    "arch": "arm64",
    "exportedAt": "2026-01-04T15:59:42.542Z",
    "evaluationCreatedAt": "2026-01-04T15:59:31.956Z"
  }
}