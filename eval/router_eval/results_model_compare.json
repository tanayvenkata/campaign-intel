{
  "evalId": "eval-mhd-2026-01-04T15:48:12",
  "results": {
    "version": 3,
    "timestamp": "2026-01-04T15:48:12.444Z",
    "prompts": [
      {
        "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "id": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "provider": "claude-3-haiku",
        "metrics": {
          "score": 19.5,
          "testPassCount": 19,
          "testFailCount": 1,
          "testErrorCount": 0,
          "assertPassCount": 39,
          "assertFailCount": 1,
          "totalLatencyMs": 22451,
          "tokenUsage": {
            "prompt": 53498,
            "completion": 1236,
            "cached": 0,
            "total": 54734,
            "numRequests": 20,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      },
      {
        "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}",
        "id": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "provider": "claude-haiku-4.5",
        "metrics": {
          "score": 10,
          "testPassCount": 0,
          "testFailCount": 20,
          "testErrorCount": 0,
          "assertPassCount": 20,
          "assertFailCount": 20,
          "totalLatencyMs": 27521,
          "tokenUsage": {
            "prompt": 53498,
            "completion": 1068,
            "cached": 0,
            "total": 54566,
            "numRequests": 20,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      }
    ],
    "results": [
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;\n"
              }
            }
          ]
        },
        "id": "4a14036e-5c23-482d-82f6-28d9b1159d3b",
        "latencyMs": 1219,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Ohio voters say about jobs?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\n    \"race-007-fg-001-cleveland-suburbs\",\n    \"race-007-fg-002-columbus-educated\",\n    \"race-007-fg-003-youngstown-working-class\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 2749,
            "prompt": 2677,
            "completion": 72,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Ohio voters say about jobs?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Ohio voters say about jobs?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;\n"
              }
            }
          ]
        },
        "id": "731d1a07-cae4-4fe7-8bff-05076fbdb1af",
        "latencyMs": 1048,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Ohio voters say about jobs?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-007-fg-001-cleveland-suburbs\",\n    \"race-007-fg-002-columbus-educated\",\n    \"race-007-fg-003-youngstown-working-class\"\n  ]\n}",
          "tokenUsage": {
            "total": 2744,
            "prompt": 2677,
            "completion": 67,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Ohio voters say about jobs?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Ohio voters say about jobs?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
              }
            }
          ]
        },
        "id": "cf819492-32bb-4311-883f-58d3924597a0",
        "latencyMs": 2146,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do Michigan voters feel about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-001-fg-001-detroit-suburbs\", \"race-001-fg-002-grand-rapids\", \"race-001-fg-003-swing-voters-statewide\", \"race-001-fg-004-northern-rural\", \"race-009-fg-001-detroit-suburbs\", \"race-009-fg-002-flint-saginaw\", \"race-009-fg-003-grand-rapids\"]}\n```",
          "tokenUsage": {
            "total": 2792,
            "prompt": 2678,
            "completion": 114,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do Michigan voters feel about the economy?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do Michigan voters feel about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
              }
            }
          ]
        },
        "id": "6e80aaec-6855-4687-a9d8-29efe905a5c2",
        "latencyMs": 1916,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do Michigan voters feel about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-001-fg-001-detroit-suburbs\",\n    \"race-001-fg-002-grand-rapids\",\n    \"race-001-fg-003-swing-voters-statewide\",\n    \"race-001-fg-004-northern-rural\",\n    \"race-009-fg-001-detroit-suburbs\",\n    \"race-009-fg-002-flint-saginaw\",\n    \"race-009-fg-003-grand-rapids\"\n  ]\n}",
          "tokenUsage": {
            "total": 2809,
            "prompt": 2678,
            "completion": 131,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do Michigan voters feel about the economy?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do Michigan voters feel about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "f1d8f86c-1af4-4b46-baa1-8fe466302850",
        "latencyMs": 1707,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania voters on healthcare",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-002-fg-001-philadelphia-suburbs\", \"race-002-fg-002-pittsburgh-area\", \"race-002-fg-003-scranton-working-class\", \"race-010-fg-001-philadelphia-suburbs\", \"race-010-fg-002-pittsburgh\", \"race-010-fg-003-scranton-nepa\"]}\n```",
          "tokenUsage": {
            "total": 2774,
            "prompt": 2673,
            "completion": 101,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania voters on healthcare"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania voters on healthcare"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "3552b8e2-810d-41fc-af7f-f73d33c65972",
        "latencyMs": 1689,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania voters on healthcare",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-002-fg-001-philadelphia-suburbs\",\n    \"race-002-fg-002-pittsburgh-area\", \n    \"race-002-fg-003-scranton-working-class\",\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-010-fg-002-pittsburgh\",\n    \"race-010-fg-003-scranton-nepa\"\n  ]\n}",
          "tokenUsage": {
            "total": 2790,
            "prompt": 2673,
            "completion": 117,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania voters on healthcare"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania voters on healthcare"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
              }
            }
          ]
        },
        "id": "8bde9f93-ca70-4d2b-a993-b2f32bcbd539",
        "latencyMs": 1276,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Wisconsin voters think about education?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-003-fg-001-milwaukee-suburbs\", \"race-003-fg-002-madison-area\", \"race-003-fg-003-fox-valley\", \"race-012-fg-001-milwaukee-suburbs\", \"race-012-fg-002-madison\", \"race-012-fg-003-fox-valley\"]}\n```",
          "tokenUsage": {
            "total": 2769,
            "prompt": 2677,
            "completion": 92,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Wisconsin voters think about education?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Wisconsin voters think about education?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
              }
            }
          ]
        },
        "id": "9dcce959-d802-411e-99db-eb678eb0fd70",
        "latencyMs": 937,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What did Wisconsin voters think about education?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-012-fg-001-milwaukee-suburbs\",\n    \"race-012-fg-002-madison\",\n    \"race-012-fg-003-fox-valley\"\n  ]\n}",
          "tokenUsage": {
            "total": 2739,
            "prompt": 2677,
            "completion": 62,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What did Wisconsin voters think about education?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What did Wisconsin voters think about education?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));\n"
              }
            }
          ]
        },
        "id": "8e7f5ac8-55b2-43b9-8cfd-ef4c1f293778",
        "latencyMs": 1326,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Georgia voters on voting rights",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\n    \"race-004-fg-001-atlanta-suburbs\",\n    \"race-004-fg-002-atlanta-black-voters\",\n    \"race-004-fg-003-rural-southwest\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 2745,
            "prompt": 2674,
            "completion": 71,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Georgia voters on voting rights"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Georgia voters on voting rights"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));\n"
              }
            }
          ]
        },
        "id": "72a39131-d8b2-460b-9012-3afa22fe79b8",
        "latencyMs": 1026,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Georgia voters on voting rights",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-004-fg-001-atlanta-suburbs\",\n    \"race-004-fg-002-atlanta-black-voters\",\n    \"race-004-fg-003-rural-southwest\"\n  ]\n}",
          "tokenUsage": {
            "total": 2740,
            "prompt": 2674,
            "completion": 66,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Georgia voters on voting rights"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Georgia voters on voting rights"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));\n"
              }
            }
          ]
        },
        "id": "02a159e0-456b-434a-bea7-cd314fee932a",
        "latencyMs": 1643,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Arizona immigration concerns",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\"race-005-fg-001-maricopa-suburbs\", \"race-005-fg-002-latino-phoenix\", \"race-005-fg-003-tucson\"]\n}\n```",
          "tokenUsage": {
            "total": 2732,
            "prompt": 2672,
            "completion": 60,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Arizona immigration concerns"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Arizona immigration concerns"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));\n"
              }
            }
          ]
        },
        "id": "8ca1fa12-f936-4d1c-ab04-b7c1b9f1d54d",
        "latencyMs": 852,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Arizona immigration concerns",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-005-fg-001-maricopa-suburbs\",\n    \"race-005-fg-002-latino-phoenix\",\n    \"race-005-fg-003-tucson\"\n  ]\n}",
          "tokenUsage": {
            "total": 2737,
            "prompt": 2672,
            "completion": 65,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Arizona immigration concerns"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Arizona immigration concerns"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));\n"
              }
            }
          ]
        },
        "id": "42040a17-6f95-490f-b9e9-38bdca1e7970",
        "latencyMs": 1134,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: North Carolina suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\"race-011-fg-001-charlotte-suburbs\", \"race-011-fg-002-research-triangle\"]\n}\n```",
          "tokenUsage": {
            "total": 2719,
            "prompt": 2673,
            "completion": 46,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "North Carolina suburban voters"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "North Carolina suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));\n"
              }
            }
          ]
        },
        "id": "2799fb08-49a6-4732-a146-77fbf06f006c",
        "latencyMs": 733,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: North Carolina suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-011-fg-001-charlotte-suburbs\"\n  ]\n}",
          "tokenUsage": {
            "total": 2707,
            "prompt": 2673,
            "completion": 34,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "North Carolina suburban voters"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "North Carolina suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));\n"
              }
            }
          ]
        },
        "id": "0e39391c-f2a6-47e4-b53a-f2962dd1af56",
        "latencyMs": 1654,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Montana rural voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\"race-008-fg-002-rural-ranching\", \"race-008-fg-003-native-reservations\"]\n}\n```",
          "tokenUsage": {
            "total": 2720,
            "prompt": 2672,
            "completion": 48,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Montana rural voters"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Montana rural voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));\n"
              }
            }
          ]
        },
        "id": "86779dc4-6653-4fae-ad21-e04aecd16632",
        "latencyMs": 1921,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Montana rural voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-008-fg-001-billings\",\n    \"race-008-fg-002-rural-ranching\"\n  ]\n}",
          "tokenUsage": {
            "total": 2721,
            "prompt": 2672,
            "completion": 49,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Montana rural voters"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Montana rural voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
              }
            }
          ]
        },
        "id": "a3f706fc-cc57-4e93-a47f-869577f2d08a",
        "latencyMs": 881,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do working-class voters think about trade?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"all\": true}\n```",
          "tokenUsage": {
            "total": 2692,
            "prompt": 2679,
            "completion": 13,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do working-class voters think about trade?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 8,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do working-class voters think about trade?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
              }
            }
          ]
        },
        "id": "37f85cea-9411-4bd8-a52b-843b9a84d1f0",
        "latencyMs": 1141,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do working-class voters think about trade?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-002-fg-002-pittsburgh-area\",\n    \"race-003-fg-003-fox-valley\",\n    \"race-007-fg-003-youngstown-working-class\",\n    \"race-009-fg-002-flint-saginaw\"\n  ]\n}",
          "tokenUsage": {
            "total": 2766,
            "prompt": 2679,
            "completion": 87,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do working-class voters think about trade?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 8,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do working-class voters think about trade?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
              }
            }
          ]
        },
        "id": "22579081-35c4-4124-a81c-08e7ad8a4ad9",
        "latencyMs": 1876,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Latino voters on immigration",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"focus_group_ids\": [\"race-005-fg-002-latino-phoenix\", \"race-006-fg-003-latino-vegas\"]}\n```",
          "tokenUsage": {
            "total": 2715,
            "prompt": 2673,
            "completion": 42,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Latino voters on immigration"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 9,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Latino voters on immigration"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
              }
            }
          ]
        },
        "id": "063f1385-09ce-48d7-9aa6-10eaa91ec8f3",
        "latencyMs": 916,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Latino voters on immigration",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-002-fg-003-scranton-working-class\",\n    \"race-004-fg-002-atlanta-black-voters\",\n    \"race-006-fg-003-latino-vegas\"\n  ]\n}",
          "tokenUsage": {
            "total": 2742,
            "prompt": 2673,
            "completion": 69,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Latino voters on immigration"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 9,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Latino voters on immigration"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));\n"
              }
            }
          ]
        },
        "id": "cff5d7a3-f719-439f-8e09-4b7308ca1185",
        "latencyMs": 1086,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Black voters in Georgia",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\"race-004-fg-002-atlanta-black-voters\", \"race-004-fg-003-rural-southwest\"]\n}\n```",
          "tokenUsage": {
            "total": 2721,
            "prompt": 2673,
            "completion": 48,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Black voters in Georgia"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 10,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Black voters in Georgia"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));\n"
              }
            }
          ]
        },
        "id": "43ff3727-7e61-445e-96c4-7ccf0a9aaf7b",
        "latencyMs": 944,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Black voters in Georgia",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-004-fg-002-atlanta-black-voters\",\n    \"race-004-fg-003-rural-southwest\"\n  ]\n}",
          "tokenUsage": {
            "total": 2724,
            "prompt": 2673,
            "completion": 51,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Black voters in Georgia"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 10,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Black voters in Georgia"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
              }
            }
          ]
        },
        "id": "8330e151-9b2e-419a-9cb0-4392293d920f",
        "latencyMs": 1493,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: College-educated suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\n    \"race-002-fg-001-philadelphia-suburbs\",\n    \"race-007-fg-002-columbus-educated\",\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-011-fg-001-charlotte-suburbs\",\n    \"race-011-fg-002-research-triangle\",\n    \"race-012-fg-001-milwaukee-suburbs\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 2788,
            "prompt": 2674,
            "completion": 114,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "College-educated suburban voters"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 11,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "College-educated suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
              }
            }
          ]
        },
        "id": "f4942926-7ff9-4a65-b44a-74ff240ac4d9",
        "latencyMs": 1307,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: College-educated suburban voters",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-011-fg-001-charlotte-suburbs\",\n    \"race-005-fg-001-maricopa-suburbs\",\n    \"race-007-fg-002-columbus-educated\",\n    \"race-001-fg-002-grand-rapids\"\n  ]\n}",
          "tokenUsage": {
            "total": 2770,
            "prompt": 2674,
            "completion": 96,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "College-educated suburban voters"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 11,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "College-educated suburban voters"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "dc1660cd-ccf7-42c4-acc6-eb85621d28b7",
        "latencyMs": 926,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do voters think about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"all\": true}\n```",
          "tokenUsage": {
            "total": 2690,
            "prompt": 2677,
            "completion": 13,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do voters think about the economy?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 12,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do voters think about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "c483d9ea-be8e-40b7-93f8-007a69e1c2f7",
        "latencyMs": 1474,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What do voters think about the economy?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"all\": true}",
          "tokenUsage": {
            "total": 2685,
            "prompt": 2677,
            "completion": 8,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What do voters think about the economy?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 12,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What do voters think about the economy?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "edd4fee3-f4ae-432b-b193-a2e64d4b0619",
        "latencyMs": 1095,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do people feel about inflation?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"all\": true}\n```",
          "tokenUsage": {
            "total": 2689,
            "prompt": 2676,
            "completion": 13,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do people feel about inflation?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 13,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do people feel about inflation?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "a325e36b-01f0-4e83-9464-e541332d9b18",
        "latencyMs": 564,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: How do people feel about inflation?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"all\": true}",
          "tokenUsage": {
            "total": 2684,
            "prompt": 2676,
            "completion": 8,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "How do people feel about inflation?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 13,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "How do people feel about inflation?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "4b375845-e69d-4ff9-a9a1-a89fc7d3532b",
        "latencyMs": 1165,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Voter concerns about healthcare costs",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"all\": true}\n```",
          "tokenUsage": {
            "total": 2688,
            "prompt": 2675,
            "completion": 13,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Voter concerns about healthcare costs"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 14,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Voter concerns about healthcare costs"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "8b8c476a-3eff-446b-9b8c-e3391a429295",
        "latencyMs": 1134,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Voter concerns about healthcare costs",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"all\": true}",
          "tokenUsage": {
            "total": 2683,
            "prompt": 2675,
            "completion": 8,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Voter concerns about healthcare costs"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 14,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Voter concerns about healthcare costs"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function returned false\nconst result = JSON.parse(output);\nreturn result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "d08b07aa-0289-4c21-b316-08c347a08c1d",
        "latencyMs": 1756,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What messaging resonates with swing voters?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"focus_group_ids\": [\"race-001-fg-001-detroit-suburbs\", \"race-001-fg-002-grand-rapids\", \"race-001-fg-003-swing-voters-statewide\", \"race-002-fg-001-philadelphia-suburbs\", \"race-003-fg-001-milwaukee-suburbs\", \"race-003-fg-003-fox-valley\", \"race-004-fg-001-atlanta-suburbs\", \"race-005-fg-001-maricopa-suburbs\", \"race-009-fg-001-detroit-suburbs\", \"race-009-fg-003-grand-rapids\"]}",
          "tokenUsage": {
            "total": 2824,
            "prompt": 2677,
            "completion": 147,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What messaging resonates with swing voters?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 15,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What messaging resonates with swing voters?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\"\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nreturn result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
              }
            }
          ]
        },
        "id": "5a2d1538-d00b-4757-b6dd-9009a150e9a6",
        "latencyMs": 1412,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: What messaging resonates with swing voters?",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\"all\": true}\n```",
          "tokenUsage": {
            "total": 2690,
            "prompt": 2677,
            "completion": 13,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "What messaging resonates with swing voters?"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 15,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "What messaging resonates with swing voters?"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
              }
            }
          ]
        },
        "id": "0daf2a6d-1dfa-4c9c-9ac9-87ff0c22934d",
        "latencyMs": 1813,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Working-class Ohio voters on manufacturing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\"race-007-fg-003-youngstown-working-class\"]\n}\n```",
          "tokenUsage": {
            "total": 2712,
            "prompt": 2676,
            "completion": 36,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Working-class Ohio voters on manufacturing"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 16,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Working-class Ohio voters on manufacturing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
              }
            }
          ]
        },
        "id": "54a07024-7c7e-43c3-a826-e06b57227911",
        "latencyMs": 713,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Working-class Ohio voters on manufacturing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-007-fg-003-youngstown-working-class\"\n  ]\n}",
          "tokenUsage": {
            "total": 2713,
            "prompt": 2676,
            "completion": 37,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Working-class Ohio voters on manufacturing"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 16,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Working-class Ohio voters on manufacturing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "6ac8b094-7877-4fd6-9fbe-3d28f8c8452e",
        "latencyMs": 1225,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania suburban voters 2024",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-010-fg-002-pittsburgh\",\n    \"race-010-fg-003-scranton-nepa\"\n  ]\n}\n```",
          "tokenUsage": {
            "total": 2746,
            "prompt": 2675,
            "completion": 71,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania suburban voters 2024"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 17,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania suburban voters 2024"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
              }
            }
          ]
        },
        "id": "622acb35-b378-4129-8fa9-ab9d10365eb5",
        "latencyMs": 929,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Pennsylvania suburban voters 2024",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-010-fg-001-philadelphia-suburbs\",\n    \"race-010-fg-002-pittsburgh\",\n    \"race-010-fg-003-scranton-nepa\"\n  ]\n}",
          "tokenUsage": {
            "total": 2741,
            "prompt": 2675,
            "completion": 66,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Pennsylvania suburban voters 2024"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 17,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Pennsylvania suburban voters 2024"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;\n"
              }
            }
          ]
        },
        "id": "f0e1c455-1947-408f-9d10-2896cb7b1d64",
        "latencyMs": 1050,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: California voters on housing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [],\n  \"reason\": \"No focus groups match California. Available states: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"\n}\n```",
          "tokenUsage": {
            "total": 2728,
            "prompt": 2673,
            "completion": 55,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "California voters on housing"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 18,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "California voters on housing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;\n"
              }
            }
          ]
        },
        "id": "fd2ed53c-0c2d-4d27-8489-2599c3536dc6",
        "latencyMs": 683,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: California voters on housing",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}",
          "tokenUsage": {
            "total": 2707,
            "prompt": 2673,
            "completion": 34,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "California voters on housing"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 18,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "California voters on housing"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\nStack Trace: SyntaxError: Unexpected token '`', \"```json\n{\n\"... is not valid JSON\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:21)\n    at handleJavascript (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n    at /Users/tanayvenkata/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:220:25\nconst result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
              }
            }
          ]
        },
        "id": "50d0ea4e-0369-4659-91da-8d357f0e2848",
        "latencyMs": 1394,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Cleveland suburbs on local issues",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 1,
        "provider": {
          "id": "openrouter:anthropic/claude-haiku-4.5",
          "label": "claude-haiku-4.5"
        },
        "response": {
          "output": "```json\n{\n  \"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\"]\n}\n```",
          "tokenUsage": {
            "total": 2707,
            "prompt": 2674,
            "completion": 33,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Cleveland suburbs on local issues"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 19,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Cleveland suburbs on local issues"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "contains-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
              }
            }
          ]
        },
        "id": "41fabb50-2030-4eba-b0be-6f51caed63ad",
        "latencyMs": 768,
        "namedScores": {},
        "prompt": {
          "raw": "You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n- race-001-fg-001-detroit-suburbs: Michigan Governor 2022 | Detroit Suburbs (Oakland County - Troy) | 10 (6F, 4M) - Swing voters who voted Trump 2016, Biden 2020 | outcome=win\n- race-001-fg-002-grand-rapids: Michigan Governor 2022 | Grand Rapids Metro (Kent County) | 10 (5F, 5M) - Mixed partisans, economic-focused voters | outcome=win\n- race-001-fg-003-swing-voters-statewide: Michigan Governor 2022 | Virtual (Statewide Michigan) | 10 (5F, 5M) - Persuadable voters from diverse geographic regions | outcome=win\n- race-001-fg-004-northern-rural: Michigan Governor 2022 | Northern Michigan Rural (Alpena County - Alpena) | 8 (3F, 5M) - Rural voters, mostly Republican-lean, some persuadable | outcome=win\n- race-002-fg-001-philadelphia-suburbs: Pennsylvania Senate 2022 | Philadelphia Suburbs (Montgomery County - King of Prussia) | 10 (7F, 3M) - College-educated suburban voters, mixed partisans | outcome=win\n- race-002-fg-002-pittsburgh-area: Pennsylvania Senate 2022 | Pittsburgh Area (Allegheny County - Monroeville) | 10 (4F, 6M) - Union households and working-class voters | outcome=win\n- race-002-fg-003-scranton-working-class: Pennsylvania Senate 2022 | Scranton/NEPA (Lackawanna County) | 10 (5F, 5M) - Working-class persuadable voters, mixed registration | outcome=win\n- race-003-fg-001-milwaukee-suburbs: Wisconsin Senate 2022 | Milwaukee Suburbs - WOW Counties (Waukesha County - Brookfield) | 10 (6F, 4M) - Lean-R suburban voters, persuadable on margins | outcome=loss\n- race-003-fg-002-madison-area: Wisconsin Senate 2022 | Madison Area (Dane County) | 10 (5F, 5M) - Democratic base voters, motivation check | outcome=loss\n- race-003-fg-003-fox-valley: Wisconsin Senate 2022 | Fox Valley (Outagamie County - Appleton) | 10 (5F, 5M) - Swing manufacturing region voters, mixed partisans | outcome=loss\n- race-004-fg-001-atlanta-suburbs: Georgia Senate 2022 | Atlanta Suburbs (Cobb County - Marietta) | 10 (6F, 4M) - Suburban swing voters, diverse demographics | outcome=win\n- race-004-fg-002-atlanta-black-voters: Georgia Senate 2022 | Atlanta (Fulton County - Southwest Atlanta) | 10 (6F, 4M) - Black voters, mix of ages and backgrounds | outcome=win\n- race-004-fg-003-rural-southwest: Georgia Senate 2022 | Rural Southwest Georgia (Dougherty County - Albany) | 9 (5F, 4M) - Rural voters, Black Belt region, economically stressed | outcome=win\n- race-005-fg-001-maricopa-suburbs: Arizona Governor 2022 | Maricopa County Suburbs (Scottsdale/Chandler) | 10 (5F, 5M) - Suburban swing voters, includes McCain Republicans | outcome=win\n- race-005-fg-002-latino-phoenix: Arizona Governor 2022 | Phoenix Metro (Maryvale/Glendale - Latino Community) | 10 (6F, 4M) - Latino voters, mix of citizens by birth and naturalized | outcome=win\n- race-005-fg-003-tucson: Arizona Governor 2022 | Tucson (Pima County) | 10 (6F, 4M) - Progressive base, environmentalists, academics, activists | outcome=win\n- race-006-fg-001-las-vegas-union: Nevada Senate 2022 | Las Vegas (Culinary Union Hall) | 10 (6F, 4M) - Culinary Union members, hospitality workers | outcome=win\n- race-006-fg-002-reno-transplants: Nevada Senate 2022 | Reno (Washoe County) | 10 (5F, 5M) - Mix of longtime Reno residents and California transplants | outcome=win\n- race-006-fg-003-latino-vegas: Nevada Senate 2022 | Las Vegas (East Las Vegas/Henderson - Latino Community) | 10 (5F, 5M) - Latino voters, mix of union and non-union, various backgrounds | outcome=win\n- race-007-fg-001-cleveland-suburbs: Ohio Senate 2024 | Cleveland Suburbs (Cuyahoga County - Parma/Strongsville) | 10 (5F, 5M) - Suburban swing voters, mix of Biden 2020 and Trump 2020 | outcome=loss\n- race-007-fg-002-columbus-educated: Ohio Senate 2024 | Columbus Metro (Franklin County - Upper Arlington/Dublin) | 10 (6F, 4M) - College-educated professionals, suburban, mostly Biden 2020 | outcome=loss\n- race-007-fg-003-youngstown-working-class: Ohio Senate 2024 | Youngstown/Mahoning Valley (Mahoning County) | 10 (4F, 6M) - Working-class voters, union and non-union, heavily Trump 2016/2020 | outcome=loss\n- race-008-fg-001-billings: Montana Senate 2024 | Billings (Yellowstone County) | 10 (5F, 5M) - Mix of Billings residents, urban Montana context | outcome=loss\n- race-008-fg-002-rural-ranching: Montana Senate 2024 | Rural Montana (Lewistown/Fergus County) | 8 (3F, 5M) - Ranchers, farmers, rural small-town residents | outcome=loss\n- race-008-fg-003-native-reservations: Montana Senate 2024 | Crow Reservation (Big Horn County) | 9 (5F, 4M) - Native American voters from Crow and Northern Cheyenne reservations | outcome=loss\n- race-009-fg-001-detroit-suburbs: Michigan Senate 2024 | Detroit Suburbs (Oakland County - Troy/Rochester) | 10 (6F, 4M) - Suburban voters, mix of Biden 2020 and Trump 2020 | outcome=win\n- race-009-fg-002-flint-saginaw: Michigan Senate 2024 | Flint/Saginaw (Genesee/Saginaw Counties) | 10 (5F, 5M) - Working-class voters, union and non-union | outcome=win\n- race-009-fg-003-grand-rapids: Michigan Senate 2024 | Grand Rapids (Kent County) | 10 (5F, 5M) - Mix of traditional conservatives and changing suburbs | outcome=win\n- race-010-fg-001-philadelphia-suburbs: Pennsylvania Senate 2024 | Philadelphia Suburbs (Chester County - West Chester/Malvern) | 10 (6F, 4M) - Suburban professionals, mostly college-educated | outcome=win\n- race-010-fg-002-pittsburgh: Pennsylvania Senate 2024 | Pittsburgh (Allegheny County) | 10 (5F, 5M) - Mix of urban Pittsburgh and surrounding communities | outcome=win\n- race-010-fg-003-scranton-nepa: Pennsylvania Senate 2024 | Scranton/NEPA (Lackawanna/Luzerne Counties) | 10 (5F, 5M) - Working-class voters, traditional Democrats under pressure | outcome=win\n- race-011-fg-001-charlotte-suburbs: North Carolina Governor 2024 | Charlotte Suburbs (Mecklenburg/Union Counties) | 10 (6F, 4M) - Suburban voters, mix of transplants and natives | outcome=win\n- race-011-fg-002-research-triangle: North Carolina Governor 2024 | Research Triangle (Wake County - Raleigh/Cary) | 10 (5F, 5M) - Mix of Triangle professionals and residents | outcome=win\n- race-011-fg-003-rural-eastern: North Carolina Governor 2024 | Eastern North Carolina (Greenville/Pitt County) | 9 (4F, 5M) - Rural and small-town voters, mix of politics | outcome=win\n- race-012-fg-001-milwaukee-suburbs: Wisconsin Senate 2024 | Milwaukee Suburbs (WOW Counties - Waukesha/Ozaukee) | 10 (5F, 5M) - Suburban voters, traditionally Republican-leaning | outcome=win\n- race-012-fg-002-madison: Wisconsin Senate 2024 | Madison (Dane County) | 10 (6F, 4M) - Progressive base, academics, state workers | outcome=win\n- race-012-fg-003-fox-valley: Wisconsin Senate 2024 | Fox Valley (Appleton/Outagamie County) | 10 (5F, 5M) - Manufacturing region, swing voters, Schroeder's home turf | outcome=win\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: Cleveland suburbs on local issues",
          "label": "prompts/router_v2.txt: You are a focus group search filter. Given a user query, determine which focus groups are relevant.\n\nAVAILABLE FOCUS GROUPS:\n{{manifest}}\n\nYOUR TASK:\n1. Analyze the query for geographic, demographic, or other specific filters\n2. Match against the focus group metadata (state, location, demographics, outcome)\n3. Return relevant focus group IDs\n\nFILTERING RULES:\n- If query mentions a STATE (Ohio, Michigan, etc.) → return only FGs from that state\n- If query mentions a CITY (Cleveland, Detroit, etc.) → return FGs from that city/area\n- If query mentions DEMOGRAPHICS (working-class, Latino, suburban, etc.) → return FGs matching that demographic\n- If query mentions OUTCOME (lost, won, races we lost) → filter by outcome\n- If query is BROAD with no specific filters (just topics like \"economy\", \"jobs\", \"healthcare\") → return {\"all\": true}\n\nIMPORTANT:\n- Be INCLUSIVE - if in doubt, include the focus group (retrieval will handle relevance)\n- A query can have MULTIPLE filters (e.g., \"Ohio working-class\" = Ohio AND working-class)\n- If query mentions a state/location we don't have data for, return empty with reason\n\nOUTPUT FORMAT:\nReturn ONLY valid JSON, no explanations, no text before or after.\n\nExamples:\n{\"focus_group_ids\": [\"race-007-fg-001-cleveland-suburbs\", \"race-007-fg-002-columbus-educated\"]}\n{\"all\": true}\n{\"focus_group_ids\": [], \"reason\": \"No focus groups match California. Available: Michigan, Pennsylvania, Wisconsin, Georgia, Arizona, Nevada, Ohio, Montana, North Carolina\"}\n\nUser query: {{query}}"
        },
        "promptId": "a7e2f41067a7d9db3b6a7a892df483d7a3bb1eaf6f7f3e270871d006e4819d99",
        "promptIdx": 0,
        "provider": {
          "id": "openrouter:anthropic/claude-3-haiku",
          "label": "claude-3-haiku"
        },
        "response": {
          "output": "{\n  \"focus_group_ids\": [\n    \"race-007-fg-001-cleveland-suburbs\"\n  ]\n}",
          "tokenUsage": {
            "total": 2708,
            "prompt": 2674,
            "completion": 34,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 0
            }
          },
          "cached": false,
          "finishReason": "stop"
        },
        "score": 1,
        "success": true,
        "testCase": {
          "vars": {
            "manifest": "file://manifest.txt",
            "query": "Cleveland suburbs on local issues"
          },
          "assert": [
            {
              "type": "contains-json"
            },
            {
              "type": "javascript",
              "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 19,
        "vars": {
          "manifest": "file://manifest.txt",
          "query": "Cleveland suburbs on local issues"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      }
    ],
    "stats": {
      "successes": 19,
      "failures": 21,
      "errors": 0,
      "tokenUsage": {
        "prompt": 106996,
        "completion": 2304,
        "cached": 0,
        "total": 109300,
        "numRequests": 40,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      },
      "durationMs": 13170
    }
  },
  "config": {
    "tags": {},
    "description": "Router Model Comparison - Claude 3 vs Claude 4 Haiku",
    "prompts": [
      "file:///Users/tanayvenkata/dev/focus-group/eval/router_eval/prompts/router_v2.txt"
    ],
    "providers": [
      {
        "id": "openrouter:anthropic/claude-3-haiku",
        "label": "claude-3-haiku",
        "config": {
          "temperature": 0,
          "max_tokens": 500
        }
      },
      {
        "id": "openrouter:anthropic/claude-haiku-4.5",
        "label": "claude-haiku-4.5",
        "config": {
          "temperature": 0,
          "max_tokens": 500
        }
      }
    ],
    "tests": [
      {
        "vars": {
          "query": "What did Ohio voters say about jobs?"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nconst hasOhio = ids.every(id => id.includes('race-007'));\nconst hasAll = ids.length === 3;\nreturn hasOhio && hasAll;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "How do Michigan voters feel about the economy?"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-001') || id.includes('race-009'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Pennsylvania voters on healthcare"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-002') || id.includes('race-010'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What did Wisconsin voters think about education?"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-003') || id.includes('race-012'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Georgia voters on voting rights"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-004'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Arizona immigration concerns"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-005'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "North Carolina suburban voters"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-011'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Montana rural voters"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.every(id => id.includes('race-008'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What do working-class voters think about trade?"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Latino voters on immigration"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('latino') || id.includes('race-005-fg-002') || id.includes('race-006-fg-003'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Black voters in Georgia"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-004-fg-002') || id.includes('black'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "College-educated suburban voters"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length > 0 && !result.all;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What do voters think about the economy?"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "How do people feel about inflation?"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Voter concerns about healthcare costs"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "What messaging resonates with swing voters?"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nreturn result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Working-class Ohio voters on manufacturing"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-007'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Pennsylvania suburban voters 2024"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('race-010'));\n"
          }
        ]
      },
      {
        "vars": {
          "query": "California voters on housing"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.length === 0 || result.all === true;\n"
          }
        ]
      },
      {
        "vars": {
          "query": "Cleveland suburbs on local issues"
        },
        "assert": [
          {
            "type": "contains-json"
          },
          {
            "type": "javascript",
            "value": "const result = JSON.parse(output);\nconst ids = result.focus_group_ids || [];\nreturn ids.some(id => id.includes('cleveland') || id.includes('race-007-fg-001'));\n"
          }
        ]
      }
    ],
    "scenarios": [],
    "env": {},
    "defaultTest": {
      "vars": {
        "manifest": "file://manifest.txt"
      },
      "assert": [],
      "options": {},
      "metadata": {}
    },
    "outputPath": [
      "results_model_compare.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {}
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.120.8",
    "nodeVersion": "v25.2.1",
    "platform": "darwin",
    "arch": "arm64",
    "exportedAt": "2026-01-04T15:48:25.811Z",
    "evaluationCreatedAt": "2026-01-04T15:48:12.444Z"
  }
}